# YAML 翻译工具 - 产品设计文档

## 项目概述

### 项目背景
开发一个专门用于YAML文件内容翻译的Web应用，基于AI大语言模型进行智能翻译，支持自定义词典和上下文理解，帮助开发者快速将配置文件、国际化文件等YAML内容翻译成多种语言。与传统翻译API相比，AI翻译能更好地理解上下文和技术术语。

### 项目目标

#### 🎯 第一期目标 (MVP - 核心翻译功能)
- 提供简单易用的YAML文件上传和翻译功能
- 实现实时翻译预览，逐条翻译逐条显示结果
- 提供左右对照的翻译界面（源文件 vs 目标文件）
- 支持单语言实时翻译模式，确保翻译质量和用户体验
- 基础自定义词典功能（会话级别，不持久化）
- 保持YAML文件结构的完整性
- 支持翻译结果的实时编辑和即时下载

#### 🚀 第二期目标 (数据持久化与用户系统)
- 用户注册登录系统
- 翻译历史记录和会话恢复
- 持久化自定义词典管理
- 翻译成本统计和使用分析
- 多项目管理和协作功能

## 核心功能

### 1. 文件上传模块
- **功能描述**: 支持YAML文件的拖拽上传或点击上传
- **技术要求**: 
  - 文件格式验证（.yml, .yaml）
  - 文件大小限制（建议10MB以内）
  - 文件内容预览
  - YAML格式验证

### 2. 实时翻译对照模块
- **功能描述**: 提供左右分屏的实时翻译对照界面
- **核心特性**:
  - 左侧显示源YAML文件内容
  - 右侧显示目标语言翻译结果
  - 逐条翻译，实时更新右侧内容
  - 翻译进度条显示当前翻译状态
  - 支持单语言翻译模式，确保翻译质量
  - 翻译过程中可暂停/继续操作

### 3. 语言选择模块
- **功能描述**: 提供单一目标语言选择（实时翻译模式）
- **支持语言**: 
  - 中文（简体/繁体）
  - 英语
  - 日语
  - 韩语
  - 法语
  - 德语
  - 西班牙语
  - 俄语
  - 更多语言可扩展
- **交互方式**: 下拉选择器，一次只能选择一种目标语言

### 4. 会话级词典模块（第一期）
- **功能描述**: 提供临时的自定义词汇翻译规则
- **MVP功能特性**:
  - 当前会话内的关键词-翻译对管理
  - 简单的词典条目添加/编辑/删除
  - 实时词典匹配提示
  - 基础的词典导入功能（CSV/JSON格式）
  - 翻译完成后可导出词典配置
- **第二期扩展**:
  - 持久化词典存储
  - 词典版本管理和共享
  - 正则表达式匹配
  - 词典模板和优先级设置

### 5. AI流式翻译引擎模块
- **功能描述**: 基于AI大语言模型的智能翻译处理逻辑
- **AI翻译特性**:
  - 支持多种AI模型（OpenAI GPT-4、Claude、Gemini等）
  - 上下文感知的智能翻译，理解技术术语
  - 保持代码注释和技术概念的准确性
  - 支持自定义翻译风格和术语偏好
  - 流式响应，逐条实时返回翻译结果
- **技术特性**:
  - 智能识别YAML中的可翻译内容
  - 保持YAML结构和格式完整性
  - AI翻译缓存机制优化成本和性能
  - WebSocket实时通信支持
  - 翻译队列管理和错误重试机制
  - Token使用统计和成本控制

### 6. 实时编辑与下载模块（第一期）
- **功能描述**: 支持翻译结果的实时编辑和导出
- **MVP功能特性**:
  - 右侧翻译结果支持在线编辑
  - 实时预览编辑效果
  - 基础的撤销/重做操作
  - 翻译结果即时下载（YAML格式）
  - 键盘快捷键支持（Ctrl+Z, Ctrl+Y, Ctrl+S）
- **第二期扩展**:
  - 翻译会话自动保存和恢复
  - 多格式导出（JSON, CSV等）
  - 高级编辑功能（批量替换等）

## 技术架构

### 🏗️ 第一期技术栈（MVP - 无数据库）
```
- 全栈框架: Next.js 14+ (App Router)
- 运行时: Node.js 18+
- 语言: TypeScript
- UI库: Tailwind CSS + shadcn/ui
- 状态管理: Zustand (内存状态管理)
- 缓存: 内存缓存 + 浏览器localStorage
- 实时通信: Server-Sent Events (SSE)
```

### 前端模块（第一期）
```
- 文件处理: js-yaml, react-dropzone
- 代码编辑器: Monaco Editor
- 实时通信: EventSource (SSE)
- 动画: Framer Motion
- 图标: Lucide React
- 热键支持: react-hotkeys-hook
- 本地存储: localStorage (词典和会话临时存储)
```

### 后端模块（第一期 - Next.js API Routes）
```
- API路由: Next.js API Routes (App Router)
- AI服务集成: 
  - OpenAI SDK (GPT-4, GPT-3.5-turbo)
  - Anthropic SDK (Claude)
  - Google AI SDK (Gemini)
- 实时推送: Server-Sent Events
- 文件存储: Vercel Blob (临时文件存储)
- 会话管理: 内存存储 (单次会话有效)
```

### 📊 第二期技术栈扩展（数据持久化）
```
- 数据库: PostgreSQL + Prisma ORM
- 缓存: Redis (Upstash Redis)
- 任务队列: Bull MQ (Redis)
- 用户认证: NextAuth.js
- 文件存储: 永久存储方案
- 会话恢复: 数据库存储
```

### 第一期系统架构图（MVP - 无数据库）
```
┌─────────────────────────────────────────────────────────────────┐
│                Next.js 全栈应用 (第一期MVP)                     │
│  ┌─────────────────────────────────────────────────────────────┐ │
│  │                     客户端 (React)                          │ │
│  │  ┌─────────────┐    ┌─────────────────┐  ┌──────────────┐  │ │
│  │  │   源文件     │    │    目标文件      │  │   控制面板   │  │ │
│  │  │ Monaco编辑器 │    │ Monaco编辑器     │  │  - 语言选择  │  │ │
│  │  │   (只读)     │    │   (可编辑)       │  │  - 会话词典  │  │ │
│  │  └─────────────┘    └─────────────────┘  │  - 翻译控制  │  │ │
│  │          │                    ▲          └──────────────┘  │ │
│  │          │         SSE推送    │                           │ │
│  │  ┌─────────────────────────────┐                          │ │
│  │  │      本地状态管理(Zustand)    │                          │ │
│  │  │  - 翻译会话状态            │                          │ │
│  │  │  - 词典数据(临时)          │                          │ │
│  │  │  - 文件内容缓存            │                          │ │
│  │  └─────────────────────────────┘                          │ │
│  └──────────┼────────────────────┼───────────────────────────┘ │
│             │                    │                             │
│  ┌─────────────────────────────────────────────────────────────┐ │
│  │                 Next.js API Routes                          │ │
│  │  ┌─────────────┐    ┌─────────────────┐  ┌──────────────┐  │ │
│  │  │文件处理模块  │    │  AI翻译引擎      │  │内存会话管理   │  │ │
│  │  │             │◄──►│                 │◄─┤              │  │ │
│  │  │- YAML解析   │    │- OpenAI GPT-4   │  │- 会话状态    │  │ │
│  │  │- 结构验证   │    │- Claude 3       │  │- 进度跟踪    │  │ │
│  │  │- 内容提取   │    │- Gemini Pro     │  │- SSE推送     │  │ │
│  │  │- 实时处理   │    │- 流式响应       │  │- 错误处理    │  │ │
│  │  └─────────────┘    └─────────────────┘  └──────────────┘  │ │
│  │          │                    │                   │        │ │
│  │          ▼                    ▼                   ▼        │ │
│  │  ┌─────────────┐    ┌─────────────────┐  ┌──────────────┐  │ │
│  │  │会话词典模块  │    │   内存缓存      │  │临时文件存储   │  │ │
│  │  │             │    │                 │  │ (Vercel Blob)│  │ │
│  │  │- 临时词典   │    │- AI响应缓存     │  │- 上传文件    │  │ │
│  │  │- 术语匹配   │    │- 翻译结果       │  │- 翻译结果    │  │ │
│  │  │- 实时应用   │    │- 会话数据       │  │- 下载准备    │  │ │
│  │  └─────────────┘    └─────────────────┘  └──────────────┘  │ │
│  └─────────────────────────────────────────────────────────────┘ │
└─────────────────────────────────────────────────────────────────┘
                           单次会话有效，刷新页面数据丢失
```

### 第二期架构扩展（数据持久化）
```
┌─────────────────────────────────────────────────────────────────┐
│              第二期：添加数据持久化层                            │
│  ┌─────────────────────────────────────────────────────────────┐ │
│  │                   持久化存储层                               │ │
│  │  ┌─────────────┐  ┌─────────────────┐  ┌──────────────┐  │ │
│  │  │ PostgreSQL  │  │     Redis       │  │   文件存储   │  │ │
│  │  │  + Prisma   │  │    缓存层       │  │  (永久存储)  │  │ │
│  │  │- 用户系统   │  │- 会话恢复       │  │- 历史记录    │  │ │
│  │  │- 词典库     │  │- 任务队列       │  │- 项目管理    │  │ │
│  │  │- 翻译历史   │  │- 性能优化       │  │- 备份恢复    │  │ │
│  │  └─────────────┘  └─────────────────┘  └──────────────┘  │ │
│  └─────────────────────────────────────────────────────────────┘ │
└─────────────────────────────────────────────────────────────────┘
```

### 第一期模块化设计（MVP）

```
src/
├── app/                    # Next.js App Router
│   ├── api/                # API路由
│   │   ├── upload/         # 文件上传接口
│   │   ├── translate/      # AI翻译接口
│   │   │   ├── start/      # 开始翻译
│   │   │   ├── stream/     # SSE实时推送
│   │   │   └── control/    # 翻译控制
│   │   └── dictionary/     # 临时词典管理
│   ├── globals.css         # 全局样式 (Tailwind)
│   ├── layout.tsx          # 根布局
│   └── page.tsx            # 主页面（翻译界面）
├── components/             # React组件
│   ├── ui/                 # shadcn/ui组件
│   │   ├── button.tsx      # 按钮组件
│   │   ├── input.tsx       # 输入框组件
│   │   ├── progress.tsx    # 进度条组件
│   │   └── ...             # 其他UI组件
│   ├── editor/             # Monaco编辑器组件
│   │   ├── source-editor.tsx    # 源文件编辑器
│   │   ├── target-editor.tsx    # 目标编辑器
│   │   └── editor-layout.tsx    # 编辑器布局
│   ├── translation/        # 翻译功能组件
│   │   ├── control-panel.tsx    # 控制面板
│   │   ├── progress-bar.tsx     # 翻译进度
│   │   ├── language-selector.tsx # 语言选择
│   │   └── translation-status.tsx # 翻译状态
│   ├── upload/             # 文件上传组件
│   │   ├── file-upload.tsx      # 文件上传器
│   │   └── file-preview.tsx     # 文件预览
│   └── dictionary/         # 临时词典组件
│       ├── dictionary-panel.tsx # 词典面板
│       ├── dictionary-item.tsx  # 词典条目
│       └── dictionary-import.tsx # 词典导入
├── lib/                    # 工具库
│   ├── ai/                 # AI服务集成
│   │   ├── openai.ts       # OpenAI集成
│   │   ├── claude.ts       # Claude集成
│   │   ├── gemini.ts       # Gemini集成
│   │   └── translator.ts   # 翻译协调器
│   ├── yaml/               # YAML处理
│   │   ├── parser.ts       # YAML解析
│   │   ├── validator.ts    # 格式验证
│   │   └── extractor.ts    # 内容提取
│   ├── storage/            # 本地存储
│   │   ├── session.ts      # 会话存储
│   │   ├── dictionary.ts   # 词典存储
│   │   └── cache.ts        # 缓存管理
│   └── utils/              # 通用工具
├── types/                  # TypeScript类型
│   ├── translation.ts      # 翻译相关类型
│   ├── session.ts          # 会话类型
│   └── dictionary.ts       # 词典类型
├── hooks/                  # 自定义Hooks
│   ├── use-translation.ts  # 翻译状态Hook
│   ├── use-sse.ts          # SSE连接Hook
│   └── use-dictionary.ts   # 词典管理Hook
└── stores/                 # Zustand状态管理
    ├── translation-store.ts # 翻译状态
    ├── dictionary-store.ts  # 词典状态
    └── ui-store.ts          # UI状态
```

### 第二期扩展结构
```
src/
├── lib/
│   ├── db/                 # 数据库服务 (新增)
│   │   ├── prisma.ts       # Prisma客户端
│   │   ├── user.ts         # 用户操作
│   │   ├── history.ts      # 历史记录
│   │   └── dictionary.ts   # 词典持久化
│   └── auth/               # 用户认证 (新增)
│       ├── nextauth.ts     # NextAuth配置
│       └── providers.ts    # 认证提供商
└── prisma/                 # 数据库模型 (新增)
    ├── schema.prisma       # 数据模型
    └── migrations/         # 迁移文件
```

### AI翻译流程图
```
用户上传YAML文件 → Next.js文件处理 → YAML解析和验证
        ↓
提取可翻译内容 → 创建翻译会话 → 构建AI翻译上下文
        ↓
选择AI模型 → 应用自定义词典 → 流式AI翻译请求
        ↓
WebSocket/SSE推送 → 实时更新界面 → 用户可编辑结果
        ↓
翻译完成 → 缓存结果 → 导出YAML文件
```

## 开发计划

### 🎆 第一期：MVP核心功能开发（第1-4周）

#### 1.1 项目基础搭建（第1周）
- [ ] 创建Next.js 14项目 (App Router)
- [ ] 配置TypeScript + ESLint + Prettier
- [ ] 集成Tailwind CSS + shadcn/ui
- [ ] 初始化模块化文件结构
- [ ] 配置环境变量管理 (.env.local)
- [ ] 设置Zustand状态管理

#### 1.2 核心UI组件开发（第1周）
- [ ] 实现文件上传组件 (react-dropzone)
- [ ] 集成Monaco Editor左右分屏布局
- [ ] 创建翻译控制面板
- [ ] 实现语言选择器
- [ ] 构建基础的进度条组件

#### 1.3 YAML处理模块（第1周）
- [ ] 实现YAML文件解析和验证
- [ ] 创建可翻译内容提取逻辑
- [ ] 实现YAML结构保持功能
- [ ] 添加文件预览功能

#### 1.4 AI服务集成（第2周）
- [ ] 集成OpenAI SDK (GPT-4, GPT-3.5-turbo)
- [ ] 集成Anthropic Claude SDK
- [ ] 集成Google Gemini SDK
- [ ] 创建AI翻译协调器
- [ ] 实现翻译成本估算功能
- [ ] 基础错误处理和重试机制

#### 1.5 实时翻译功能（第2-3周）
- [ ] 实现Server-Sent Events (SSE)通信
- [ ] 创建流式AI翻译逻辑
- [ ] 添加实时翻译结果推送
- [ ] 实现翻译进度显示
- [ ] 添加翻译暂停/继续/停止控制

#### 1.6 会话级词典功能（第3周）
- [ ] 实现临时词典管理 (localStorage)
- [ ] 创建词典面板组件
- [ ] 添加词典条目增删改功能
- [ ] 实现翻译时的词典匹配
- [ ] 添加词典导入/导出功能

#### 1.7 编辑与导出功能（第4周）
- [ ] 实现Monaco Editor实时编辑
- [ ] 添加撤销/重做操作
- [ ] 实现键盘快捷键支持
- [ ] 创建翻译结果下载功能
- [ ] 添加多格式导出 (YAML, JSON)
- [ ] 实现内存缓存优化

### 🚀 第二期：数据持久化与用户系统（第5-8周）

#### 2.1 数据库集成（第5周）
- [ ] 集成PostgreSQL + Prisma ORM
- [ ] 设计用户数据模型
- [ ] 创建翻译历史数据结构
- [ ] 实现持久化词典模型
- [ ] 添加数据库迁移脚本

#### 2.2 用户认证系统（第5周）
- [ ] 集成NextAuth.js
- [ ] 实现用户注册/登录
- [ ] 添加OAuth提供商 (Google, GitHub)
- [ ] 创建用户配置页面
- [ ] 实现用户会话管理

#### 2.3 翻译历史系统（第6周）
- [ ] 实现翻译会话持久化
- [ ] 创建历史记录页面
- [ ] 添加会话恢复功能
- [ ] 实现翻译结果重新下载
- [ ] 添加批量操作功能

#### 2.4 高级词典系统（第6周）
- [ ] 实现持久化词典存储
- [ ] 添加词典版本管理
- [ ] 实现词典共享功能
- [ ] 添加正则表达式匹配
- [ ] 创建词典模板系统

#### 2.5 系统优化（第7周）
- [ ] 集成Redis缓存层
- [ ] 实现Bull MQ任务队列
- [ ] 添加API限流和率限制
- [ ] 优化数据库查询性能
- [ ] 集成错误监控 (Sentry)

#### 2.6 高级功能（第8周）
- [ ] 添加多项目管理
- [ ] 实现协作翻译功能
- [ ] 添加翻译质量评分系统
- [ ] 实现成本统计和分析
- [ ] 添加批量文件处理支持

### ✨ 测试和部署（贯穿整个开发过程）

#### 4.1 测试
- [ ] 单元测试覆盖
- [ ] 集成测试
- [ ] 端到端测试
- [ ] 性能测试

#### 4.2 部署
- [ ] 配置生产环境
- [ ] 实现CI/CD流程
- [ ] 服务器部署
- [ ] 域名和SSL配置

## 数据结构设计

### 用户词典结构
```yaml
custom_dictionary:
  - key: "原文关键词"
    translations:
      zh-CN: "中文翻译"
      en: "English translation"
      ja: "日本語翻訳"
    priority: 1
    regex_enabled: false
```

### 实时翻译会话结构
```yaml
translation_session:
  session_id: "uuid"
  file_id: "uuid"
  source_language: "en"
  target_language: "zh-CN"
  status: "in_progress"  # pending, in_progress, paused, completed, error
  progress:
    current_item: 5
    total_items: 150
    percentage: 3.33
  translation_items:
    - id: "config.app.name"
      original: "Application Name"
      translated: "应用程序名称"
      status: "completed"
      position:
        line: 5
        column: 8
  custom_dictionary: {}
  created_at: "2024-01-01T10:00:00Z"
  updated_at: "2024-01-01T10:05:00Z"
```

## API 接口设计

### 文件上传
```
POST /api/upload
Content-Type: multipart/form-data
Body: file

Response:
{
  "success": true,
  "file_id": "uuid",
  "preview": "yaml content preview"
}
```

### AI翻译API设计

#### 开始AI翻译
```typescript
POST /api/translate/start
Content-Type: application/json
Body: {
  file_id: string;
  target_language: string;
  ai_model: 'gpt-4' | 'claude-3' | 'gemini-pro';
  custom_dictionary?: Record<string, string>;
  translation_style?: 'technical' | 'casual' | 'formal';
  preserve_formatting?: boolean;
}

Response: {
  success: boolean;
  session_id: string;
  total_items: number;
  estimated_cost?: number;  // AI成本估算
  sse_endpoint: string;     // Server-Sent Events端点
}
```

#### Server-Sent Events 实时翻译
```typescript
GET /api/translate/stream?session_id=uuid

// 事件类型定义
type TranslationEvent = 
  | {
      type: 'started';
      session_id: string;
      ai_model: string;
      total_items: number;
    }
  | {
      type: 'progress';
      session_id: string;
      current_item: number;
      total_items: number;
      percentage: number;
      estimated_remaining_time?: number;
    }
  | {
      type: 'item_result';
      session_id: string;
      item_id: string;
      original: string;
      translated: string;
      confidence_score?: number;  // AI翻译置信度
      ai_reasoning?: string;      // AI翻译推理过程
      position: { line: number; column: number };
    }
  | {
      type: 'completed';
      session_id: string;
      final_yaml: string;
      total_cost: number;         // 实际AI成本
      translation_time: number;   // 翻译耗时
    }
  | {
      type: 'error';
      session_id: string;
      error_code: string;
      error_message: string;
    };
```

#### 翻译会话控制
```typescript
POST /api/translate/control
Body: {
  session_id: string;
  action: 'pause' | 'resume' | 'stop' | 'retry_failed';
}

// AI模型管理
GET /api/ai/models
Response: {
  models: Array<{
    id: string;
    name: string;
    provider: 'openai' | 'anthropic' | 'google';
    cost_per_token: number;
    max_context_length: number;
    supports_streaming: boolean;
  }>;
}

// 成本估算
POST /api/translate/estimate
Body: {
  file_id: string;
  ai_model: string;
  target_language: string;
}
Response: {
  estimated_tokens: number;
  estimated_cost: number;
  estimated_time: number;
}
```

## 部署方案

### 开发环境配置
```bash
# 克隆项目并安装依赖
git clone <repo>
cd trans-yaml
npm install

# 环境变量配置 (.env.local)
OPENAI_API_KEY=your_openai_key
ANTHROPIC_API_KEY=your_claude_key
GOOGLE_AI_API_KEY=your_gemini_key
DATABASE_URL=postgresql://...
REDIS_URL=redis://...
NEXTAUTH_URL=http://localhost:3000
NEXTAUTH_SECRET=your_secret

# 数据库初始化
npx prisma generate
npx prisma db push

# 启动开发服务器
npm run dev
```

### 生产环境部署

#### Vercel 部署（推荐）
```bash
# 安装Vercel CLI
npm i -g vercel

# 部署到Vercel
vercel --prod

# 环境变量配置
vercel env add OPENAI_API_KEY
vercel env add DATABASE_URL
vercel env add REDIS_URL
```

#### Docker部署
```dockerfile
# Dockerfile
FROM node:18-alpine AS builder
WORKDIR /app
COPY package*.json ./
RUN npm ci --only=production

COPY . .
RUN npx prisma generate
RUN npm run build

FROM node:18-alpine AS runner
WORKDIR /app
COPY --from=builder /app/public ./public
COPY --from=builder /app/.next ./.next
COPY --from=builder /app/node_modules ./node_modules
COPY --from=builder /app/package.json ./package.json

EXPOSE 3000
CMD ["npm", "start"]
```

#### 云服务配置
```yaml
# 数据库: Vercel Postgres / Supabase
# 缓存: Upstash Redis
# 文件存储: Vercel Blob / AWS S3
# 监控: Vercel Analytics + Sentry
# CI/CD: GitHub Actions + Vercel
```

## 成本估算

### 第一期开发成本（MVP）
- 开发时间: 4周 (专注核心翻译功能)
- 开发人员: 1人
- 技术栈成本: 
  - Next.js: 免费
  - Vercel部署: $0 (Hobby计划)
  - 文件存储: $0-5/月 (Vercel Blob)
  - 无数据库成本

### 第二期开发成本（数据持久化）
- 开发时间: 4周 (用户系统和数据存储)
- 开发人员: 1-2人
- 新增技术栈成本:
  - 数据库: $0-25/月 (Vercel Postgres/Supabase)
  - Redis缓存: $0-10/月 (Upstash)
  - 认证服务: $0 (NextAuth.js免费)

### AI翻译成本（按使用量）
```typescript
// AI服务定价 (2024年估算)
const AI_PRICING = {
  'gpt-4-turbo': {
    input: 0.01,   // $/1K tokens
    output: 0.03   // $/1K tokens
  },
  'claude-3-sonnet': {
    input: 0.003,  // $/1K tokens  
    output: 0.015  // $/1K tokens
  },
  'gemini-pro': {
    input: 0.0005, // $/1K tokens
    output: 0.0015 // $/1K tokens
  }
};

// 单个YAML文件翻译成本预估
// 小文件 (100行): $0.01-0.05
// 中文件 (500行): $0.05-0.25  
// 大文件 (2000行): $0.20-1.00
```

### 运营成本
- 基础设施: $0-50/月 (根据规模)
- AI API调用: 按实际使用量计费
- 监控工具: $0-25/月 (Sentry免费版/付费版)
- 域名和SSL: $10-20/年

## 风险评估

### 技术风险
- AI模型API的稳定性和费用波动
- 大文件翻译的Token限制和成本控制
- 不同YAML格式和复杂结构的兼容性
- Next.js SSR/SSG与实时功能的平衡

### 业务风险
- AI翻译成本的不可预测性
- 用户上传内容的安全和隐私
- AI模型输出的准确性和一致性
- 服务可用性和性能保障

### 缓解措施
- 集成多个AI模型提供商，实现负载均衡
- 实现智能成本控制和用量预警
- 添加文件大小限制和内容安全检查
- 实现完善的错误处理和降级方案
- 使用Redis缓存减少重复AI调用
- 定期备份翻译数据和用户配置

## 用户界面设计

### 主界面布局
```
┌─────────────────────────────────────────────────────┐
│  YAML 翻译工具                    [设置] [帮助]      │
├─────────────────────────────────────────────────────┤
│ [上传文件] [选择语言: 中文 ▼] [开始翻译] [暂停] [停止] │
├─────────────────┬──┬────────────────────────────────────┤
│                 │  │                                   │
│   源文件内容     │  │         翻译结果                   │
│                 │  │                                   │
│  1  app:        │  │  1  app:                         │
│  2    name: "App"│  │  2    name: "应用程序"           │
│  3    version: 1 │  │  3    version: 1                 │
│  4    config:   │  │  4    config:                     │
│  5      db: ".."│◄─┼─►5      db: "数据库连接"          │
│  6              │  │  6                                │
│                 │  │                                   │
└─────────────────┴──┴────────────────────────────────────┤
│ 进度: ████████░░ 80% (120/150) | 耗时: 2:35 | [下载结果] │
└─────────────────────────────────────────────────────────┘
```

### 交互说明
- **左侧源文件区**: 只读显示，高亮当前翻译行
- **右侧翻译区**: 支持编辑，实时更新
- **进度条**: 显示翻译进度和统计信息
- **控制按钮**: 翻译控制和结果导出

## 后续扩展

### 功能扩展
- 支持更多文件格式（JSON, XML, Properties）
- 添加翻译质量评分和建议
- 实现多人协作翻译功能
- 添加翻译版本控制和对比
- 支持批量文件处理
- 添加翻译模板和预设

### 集成扩展
- GitHub集成（直接从仓库导入文件）
- CI/CD工具集成
- Slack/Teams通知集成
- API开放给第三方使用
- VS Code插件开发
- 企业级SSO集成

---

## 开发准备清单

### 环境准备
- [ ] Node.js 18+ 环境配置
- [ ] Git版本控制设置
- [ ] VSCode + Next.js插件配置
- [ ] PostgreSQL数据库环境
- [ ] Redis缓存服务设置

### API账号准备
- [ ] OpenAI API密钥申请 (GPT-4访问权限)
- [ ] Anthropic API密钥申请 (Claude访问权限)  
- [ ] Google AI API密钥申请 (Gemini访问权限)
- [ ] Vercel账号注册 (部署平台)
- [ ] Upstash Redis账号 (云Redis服务)
- [ ] Sentry账号 (错误监控)

### 技术选型验证
- [ ] Next.js 14 App Router特性测试
- [ ] Monaco Editor集成验证
- [ ] AI SDK集成测试 (OpenAI/Anthropic/Google)
- [ ] Server-Sent Events实时通信测试
- [ ] Prisma ORM + PostgreSQL连接测试
- [ ] Bull MQ任务队列功能验证

### 项目搭建
```bash
# 创建Next.js项目
npx create-next-app@latest trans-yaml --typescript --tailwind --eslint --app

# 第一期MVP依赖安装
npm install zustand js-yaml
npm install openai @anthropic-ai/sdk @google-ai/generativelanguage
npm install @monaco-editor/react react-dropzone react-hotkeys-hook
npm install framer-motion lucide-react

# 第二期扩展依赖
npm install @prisma/client prisma bullmq ioredis
npm install next-auth

# 开发依赖  
npm install -D @types/js-yaml @types/node
```

### 部署准备
- [ ] Vercel项目配置
- [ ] 环境变量管理策略
- [ ] 数据库迁移脚本
- [ ] CI/CD流程设计
- [ ] 性能监控配置

这份优化后的产品设计文档基于**Next.js全栈**和**AI翻译**技术，提供了完整的**模块化开发指南**，支持实时翻译预览和左右对照的用户体验。